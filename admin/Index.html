<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin OSIS - Panel Pengelolaan Aspirasi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Warna Admin (Biru Tua & Merah) */
            --admin-blue: #1e3a8a;
            --admin-blue-light: #3b82f6;
            --admin-blue-dark: #1e40af;
            --admin-red: #dc2626;
            --admin-green: #10b981;
            --admin-yellow: #f59e0b;
            --admin-purple: #8b5cf6;
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius: 10px;
            --radius-lg: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --gradient: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
        }
        
        /* Dark Theme Variables */
        .dark-mode {
            --admin-blue: #3b82f6;
            --admin-blue-light: #60a5fa;
            --admin-blue-dark: #1d4ed8;
            --admin-red: #ef4444;
            --admin-green: #34d399;
            --admin-yellow: #fbbf24;
            --admin-purple: #a78bfa;
            --white: #111827;
            --gray-50: #1f2937;
            --gray-100: #374151;
            --gray-200: #4b5563;
            --gray-300: #6b7280;
            --gray-400: #9ca3af;
            --gray-500: #d1d5db;
            --gray-600: #e5e7eb;
            --gray-700: #f3f4f6;
            --gray-800: #f9fafb;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.6;
            transition: var(--transition);
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            line-height: 1.3;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Admin Header */
        .admin-header {
            background: var(--gradient);
            color: white;
            padding: 20px 0;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .admin-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .admin-logo-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .admin-logo-text h1 {
            font-size: 24px;
            color: white;
        }
        
        .admin-logo-text p {
            font-size: 14px;
            opacity: 0.9;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .admin-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .admin-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .admin-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .admin-btn.logout {
            background: var(--admin-red);
        }
        
        .admin-btn.logout:hover {
            background: #b91c1c;
        }
        
        /* Admin Main Layout */
        .admin-main {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
            padding: 30px 0;
            min-height: calc(100vh - 120px);
        }
        
        /* Sidebar */
        .admin-sidebar {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
            border: 1px solid var(--gray-200);
        }
        
        .admin-nav {
            margin-bottom: 30px;
        }
        
        .admin-nav-title {
            font-size: 14px;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            padding-left: 10px;
        }
        
        .admin-nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            color: var(--gray-700);
            text-decoration: none;
            border-radius: var(--radius);
            margin-bottom: 8px;
            transition: var(--transition);
            border-left: 3px solid transparent;
        }
        
        .admin-nav-item:hover {
            background: var(--gray-100);
            color: var(--admin-blue);
            border-left-color: var(--admin-blue);
        }
        
        .admin-nav-item.active {
            background: rgba(30, 58, 138, 0.1);
            color: var(--admin-blue);
            border-left-color: var(--admin-blue);
            font-weight: 500;
        }
        
        .admin-nav-item i {
            width: 20px;
            text-align: center;
        }
        
        .stats-summary {
            background: var(--gray-50);
            border-radius: var(--radius);
            padding: 20px;
            border: 1px solid var(--gray-200);
        }
        
        .stats-summary h4 {
            color: var(--admin-blue);
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            color: var(--gray-600);
            font-size: 14px;
        }
        
        .stat-value {
            font-weight: 600;
            color: var(--admin-blue);
        }
        
        /* Main Content */
        .admin-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        /* Content Header */
        .content-header {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 25px 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-200);
        }
        
        .content-header h2 {
            color: var(--admin-blue);
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .content-header p {
            color: var(--gray-600);
            margin-bottom: 20px;
        }
        
        .quick-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 10px 20px;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            color: var(--gray-700);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .action-btn:hover {
            background: var(--gray-200);
            transform: translateY(-2px);
        }
        
        .action-btn.primary {
            background: var(--admin-blue);
            color: white;
            border-color: var(--admin-blue);
        }
        
        .action-btn.primary:hover {
            background: var(--admin-blue-dark);
        }
        
        .action-btn.success {
            background: var(--admin-green);
            color: white;
            border-color: var(--admin-green);
        }
        
        .action-btn.success:hover {
            background: #0da271;
        }
        
        .action-btn.warning {
            background: var(--admin-yellow);
            color: white;
            border-color: var(--admin-yellow);
        }
        
        .action-btn.warning:hover {
            background: #d97706;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        /* Cards */
        .dashboard-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-200);
            transition: var(--transition);
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-header h3 {
            color: var(--admin-blue);
            font-size: 18px;
        }
        
        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .icon-blue {
            background: var(--admin-blue);
        }
        
        .icon-green {
            background: var(--admin-green);
        }
        
        .icon-red {
            background: var(--admin-red);
        }
        
        .icon-yellow {
            background: var(--admin-yellow);
        }
        
        .icon-purple {
            background: var(--admin-purple);
        }
        
        .card-content {
            margin-bottom: 20px;
        }
        
        .card-content p {
            color: var(--gray-600);
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .card-number {
            font-size: 32px;
            font-weight: 700;
            color: var(--admin-blue);
            margin-bottom: 10px;
        }
        
        /* Submissions Table */
        .submissions-table-container {
            background: var(--white);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-200);
        }
        
        .table-header {
            background: var(--gray-50);
            padding: 20px 25px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .table-header h3 {
            color: var(--admin-blue);
        }
        
        .table-controls {
            display: flex;
            gap: 10px;
        }
        
        .table-control {
            padding: 8px 15px;
            background: var(--white);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            color: var(--gray-700);
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
        }
        
        .table-control:hover {
            background: var(--gray-100);
        }
        
        .table-control.active {
            background: var(--admin-blue);
            color: white;
            border-color: var(--admin-blue);
        }
        
        .submissions-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .submissions-table th {
            background: var(--gray-50);
            padding: 15px 20px;
            text-align: left;
            color: var(--gray-700);
            font-weight: 600;
            border-bottom: 2px solid var(--gray-200);
            font-size: 14px;
            white-space: nowrap;
        }
        
        .submissions-table td {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-200);
            color: var(--gray-700);
            font-size: 14px;
        }
        
        .submissions-table tr:hover {
            background: var(--gray-50);
        }
        
        .submissions-table tr:last-child td {
            border-bottom: none;
        }
        
        /* Badges */
        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }
        
        .badge-aspiration {
            background: rgba(16, 185, 129, 0.1);
            color: var(--admin-green);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .badge-critique {
            background: rgba(239, 68, 68, 0.1);
            color: var(--admin-red);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }
        
        .badge-status {
            background: rgba(30, 58, 138, 0.1);
            color: var(--admin-blue);
            border: 1px solid rgba(30, 58, 138, 0.2);
        }
        
        .badge-processed {
            background: rgba(245, 158, 11, 0.1);
            color: var(--admin-yellow);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        
        .badge-completed {
            background: rgba(16, 185, 129, 0.1);
            color: var(--admin-green);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .badge-priority {
            background: rgba(139, 92, 246, 0.1);
            color: var(--admin-purple);
            border: 1px solid rgba(139, 92, 246, 0.2);
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn-small {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            color: white;
            font-size: 14px;
        }
        
        .action-btn-small.reply {
            background: var(--admin-blue);
        }
        
        .action-btn-small.reply:hover {
            background: var(--admin-blue-dark);
        }
        
        .action-btn-small.edit {
            background: var(--admin-yellow);
        }
        
        .action-btn-small.edit:hover {
            background: #d97706;
        }
        
        .action-btn-small.delete {
            background: var(--admin-red);
        }
        
        .action-btn-small.delete:hover {
            background: #b91c1c;
        }
        
        .action-btn-small.view {
            background: var(--admin-green);
        }
        
        .action-btn-small.view:hover {
            background: #0da271;
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: var(--white);
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--gray-200);
        }
        
        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--admin-blue);
            color: white;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }
        
        .modal-header h2 {
            color: white;
            font-size: 20px;
        }
        
        .close-modal {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .modal-section {
            margin-bottom: 30px;
        }
        
        .modal-section:last-child {
            margin-bottom: 0;
        }
        
        .modal-section h3 {
            color: var(--admin-blue);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--gray-200);
            font-size: 18px;
        }
        
        .submission-details {
            background: var(--gray-50);
            border-radius: var(--radius);
            padding: 20px;
            border: 1px solid var(--gray-200);
            margin-bottom: 20px;
        }
        
        .detail-row {
            display: flex;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .detail-row:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .detail-label {
            width: 150px;
            color: var(--gray-600);
            font-weight: 500;
        }
        
        .detail-value {
            flex: 1;
            color: var(--gray-800);
        }
        
        .message-box {
            background: var(--white);
            border-radius: var(--radius);
            padding: 20px;
            border: 1px solid var(--gray-200);
            margin-bottom: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .message-box p {
            color: var(--gray-700);
            line-height: 1.7;
        }
        
        /* Form */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--gray-700);
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 14px;
            transition: var(--transition);
            background: var(--white);
            color: var(--gray-800);
            font-family: 'Inter', sans-serif;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--admin-blue);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
            line-height: 1.6;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-200);
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--admin-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--admin-blue-dark);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: var(--gray-200);
            color: var(--gray-700);
        }
        
        .btn-secondary:hover {
            background: var(--gray-300);
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--admin-green);
            color: white;
        }
        
        .btn-success:hover {
            background: #0da271;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: var(--admin-red);
            color: white;
        }
        
        .btn-danger:hover {
            background: #b91c1c;
            transform: translateY(-2px);
        }
        
        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--gradient);
            padding: 20px;
        }
        
        .login-box {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: var(--shadow-xl);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .login-header h1 {
            color: var(--admin-blue);
            margin-bottom: 10px;
        }
        
        .login-header p {
            color: var(--gray-600);
        }
        
        .login-logo {
            width: 80px;
            height: 80px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 32px;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .admin-main {
                grid-template-columns: 1fr;
            }
            
            .admin-sidebar {
                display: none;
            }
            
            .mobile-menu-btn {
                display: flex !important;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }
            
            .admin-header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .admin-controls {
                width: 100%;
                justify-content: center;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .table-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .table-controls {
                width: 100%;
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .submissions-table {
                display: block;
                overflow-x: auto;
            }
        }
        
        @media (max-width: 480px) {
            .modal {
                width: 95%;
                margin: 10px;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .login-box {
                padding: 30px 20px;
            }
        }
        
        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--admin-blue);
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .mobile-sidebar {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100vh;
            background: var(--white);
            z-index: 2000;
            transition: left 0.3s;
            box-shadow: var(--shadow-xl);
            overflow-y: auto;
            padding: 20px;
        }
        
        .mobile-sidebar.show {
            left: 0;
        }
        
        .mobile-sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .mobile-sidebar-header h3 {
            color: var(--admin-blue);
        }
        
        .close-mobile-sidebar {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--gray-600);
            cursor: pointer;
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(30, 58, 138, 0.3);
            border-radius: 50%;
            border-top-color: var(--admin-blue);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Login Page (Default) -->
    <div id="loginPage" class="login-container">
        <div class="login-box fade-in">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-lock"></i>
                </div>
                <h1>Admin OSIS Login</h1>
                <p>Masuk ke panel admin untuk mengelola aspirasi siswa</p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" class="form-control" placeholder="Masukkan username" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" class="form-control" placeholder="Masukkan password" required>
                </div>
                
                <div class="form-group">
                    <label for="role">Peran</label>
                    <select id="role" class="form-control" required>
                        <option value="">Pilih peran</option>
                        <option value="admin">Admin Utama</option>
                        <option value="pengurus">Pengurus OSIS</option>
                        <option value="seksi">Seksi Aspirasi</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">
                    <i class="fas fa-sign-in-alt"></i>
                    Masuk ke Dashboard
                </button>
                
                <p style="text-align: center; margin-top: 20px; color: var(--gray-500); font-size: 14px;">
                    <i class="fas fa-info-circle"></i> Hanya untuk pengurus OSIS yang berwenang
                </p>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard (Hidden by Default) -->
    <div id="adminDashboard" style="display: none;">
        <!-- Header -->
        <header class="admin-header">
            <div class="container">
                <div class="admin-header-content">
                    <div class="admin-logo">
                        <div class="admin-logo-icon">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <div class="admin-logo-text">
                            <h1>Panel Admin OSIS</h1>
                            <p>Selamat datang, <span id="adminName">Administrator</span></p>
                        </div>
                    </div>
                    
                    <div class="admin-controls">
                        <button class="admin-btn" id="themeToggle">
                            <i class="fas fa-moon"></i>
                            <span>Mode Gelap</span>
                        </button>
                        <button class="admin-btn" id="refreshBtn">
                            <i class="fas fa-sync-alt"></i>
                            <span>Refresh Data</span>
                        </button>
                        <button class="admin-btn logout" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Keluar</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container">
            <div class="admin-main">
                <!-- Sidebar -->
                <aside class="admin-sidebar">
                    <nav class="admin-nav">
                        <div class="admin-nav-title">Menu Utama</div>
                        <a href="#" class="admin-nav-item active" data-page="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a>
                        <a href="#" class="admin-nav-item" data-page="submissions">
                            <i class="fas fa-inbox"></i>
                            <span>Semua Aspirasi</span>
                            <span class="badge badge-status" id="sidebarPendingCount">0</span>
                        </a>
                        <a href="#" class="admin-nav-item" data-page="pending">
                            <i class="fas fa-clock"></i>
                            <span>Menunggu Balasan</span>
                        </a>
                        <a href="#" class="admin-nav-item" data-page="completed">
                            <i class="fas fa-check-circle"></i>
                            <span>Selesai Dibalas</span>
                        </a>
                        <a href="#" class="admin-nav-item" data-page="public">
                            <i class="fas fa-eye"></i>
                            <span>Tampilan Publik</span>
                        </a>
                    </nav>
                    
                    <nav class="admin-nav">
                        <div class="admin-nav-title">Pengelolaan</div>
                        <a href="#" class="admin-nav-item" data-page="categories">
                            <i class="fas fa-tags"></i>
                            <span>Kategori</span>
                        </a>
                        <a href="#" class="admin-nav-item" data-page="templates">
                            <i class="fas fa-file-alt"></i>
                            <span>Template Balasan</span>
                        </a>
                        <a href="#" class="admin-nav-item" data-page="reports">
                            <i class="fas fa-chart-bar"></i>
                            <span>Laporan</span>
                        </a>
                        <a href="#" class="admin-nav-item" data-page="settings">
                            <i class="fas fa-cog"></i>
                            <span>Pengaturan</span>
                        </a>
                    </nav>
                    
                    <div class="stats-summary">
                        <h4>Statistik Hari Ini</h4>
                        <div class="stat-item">
                            <span class="stat-label">Aspirasi Baru</span>
                            <span class="stat-value" id="statToday">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Dibalas</span>
                            <span class="stat-value" id="statReplied">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Rata Waktu</span>
                            <span class="stat-value" id="statAvgTime">0h</span>
                        </div>
                    </div>
                </aside>

                <!-- Content Area -->
                <div class="admin-content">
                    <!-- Dashboard Page -->
                    <div id="dashboardPage" class="page-content active">
                        <div class="content-header">
                            <h2>Dashboard Admin</h2>
                            <p>Kelola semua aspirasi dan kritik dari siswa secara efisien</p>
                            <div class="quick-actions">
                                <button class="action-btn primary" id="quickReply">
                                    <i class="fas fa-reply"></i>
                                    Balas yang Tertunda
                                </button>
                                <button class="action-btn success" id="markAllProcessed">
                                    <i class="fas fa-check-double"></i>
                                    Tandai Semua Diproses
                                </button>
                                <button class="action-btn warning" id="exportData">
                                    <i class="fas fa-download"></i>
                                    Export Data
                                </button>
                            </div>
                        </div>
                        
                        <div class="dashboard-grid">
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3>Total Aspirasi</h3>
                                    <div class="card-icon icon-blue">
                                        <i class="fas fa-inbox"></i>
                                    </div>
                                </div>
                                <div class="card-content">
                                    <div class="card-number" id="totalCount">0</div>
                                    <p>Jumlah total aspirasi dan kritik yang masuk</p>
                                </div>
                            </div>
                            
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3>Menunggu Balasan</h3>
                                    <div class="card-icon icon-yellow">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                </div>
                                <div class="card-content">
                                    <div class="card-number" id="pendingCount">0</div>
                                    <p>Belum ada balasan dari OSIS</p>
                                </div>
                            </div>
                            
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3>Selesai Dibalas</h3>
                                    <div class="card-icon icon-green">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                </div>
                                <div class="card-content">
                                    <div class="card-number" id="completedCount">0</div>
                                    <p>Sudah mendapatkan balasan OSIS</p>
                                </div>
                            </div>
                            
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3>Rata-rata Waktu</h3>
                                    <div class="card-icon icon-purple">
                                        <i class="fas fa-stopwatch"></i>
                                    </div>
                                </div>
                                <div class="card-content">
                                    <div class="card-number" id="avgResponseTime">0h</div>
                                    <p>Rata-rata waktu balasan OSIS</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="submissions-table-container">
                            <div class="table-header">
                                <h3>Aspirasi Terbaru</h3>
                                <div class="table-controls">
                                    <button class="table-control active" data-filter="all">Semua</button>
                                    <button class="table-control" data-filter="aspiration">Aspirasi</button>
                                    <button class="table-control" data-filter="critique">Kritik</button>
                                    <button class="table-control" data-filter="urgent">Mendesak</button>
                                </div>
                            </div>
                            
                            <table class="submissions-table">
                                <thead>
                                    <tr>
                                        <th>ID Tiket</th>
                                        <th>Tanggal</th>
                                        <th>Jenis</th>
                                        <th>Kategori</th>
                                        <th>Status</th>
                                        <th>Prioritas</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="recentSubmissions">
                                    <!-- Data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Submissions Page -->
                    <div id="submissionsPage" class="page-content" style="display: none;">
                        <div class="content-header">
                            <h2>Semua Aspirasi & Kritik</h2>
                            <p>Kelola semua masukan dari siswa. Filter berdasarkan jenis, status, atau prioritas.</p>
                            <div class="quick-actions">
                                <button class="action-btn primary" id="filterAll">
                                    <i class="fas fa-list"></i>
                                    Semua
                                </button>
                                <button class="action-btn" id="filterPending">
                                    <i class="fas fa-clock"></i>
                                    Tertunda
                                </button>
                                <button class="action-btn" id="filterCompleted">
                                    <i class="fas fa-check"></i>
                                    Selesai
                                </button>
                                <button class="action-btn warning" id="filterUrgent">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Mendesak
                                </button>
                            </div>
                        </div>
                        
                        <div class="submissions-table-container">
                            <div class="table-header">
                                <h3>Daftar Aspirasi (<span id="filteredCount">0</span> item)</h3>
                                <div class="table-controls">
                                    <input type="text" id="searchInput" class="form-control" placeholder="Cari ID atau kata kunci..." style="width: 200px;">
                                    <select id="categoryFilter" class="form-control" style="width: 150px;">
                                        <option value="">Semua Kategori</option>
                                    </select>
                                    <select id="statusFilter" class="form-control" style="width: 150px;">
                                        <option value="">Semua Status</option>
                                        <option value="received">Diterima</option>
                                        <option value="processed">Diproses</option>
                                        <option value="completed">Selesai</option>
                                    </select>
                                </div>
                            </div>
                            
                            <table class="submissions-table">
                                <thead>
                                    <tr>
                                        <th width="50">
                                            <input type="checkbox" id="selectAll">
                                        </th>
                                        <th>ID Tiket</th>
                                        <th>Tanggal</th>
                                        <th>Jenis</th>
                                        <th>Kategori</th>
                                        <th>Status</th>
                                        <th>Prioritas</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="allSubmissions">
                                    <!-- Data will be loaded here -->
                                </tbody>
                            </table>
                            
                            <div style="padding: 20px; background: var(--gray-50); border-top: 1px solid var(--gray-200);">
                                <button class="btn btn-secondary" id="bulkProcess">
                                    <i class="fas fa-play-circle"></i>
                                    Proses Terpilih
                                </button>
                                <button class="btn btn-success" id="bulkComplete">
                                    <i class="fas fa-check-double"></i>
                                    Tandai Selesai
                                </button>
                                <button class="btn btn-danger" id="bulkDelete">
                                    <i class="fas fa-trash"></i>
                                    Hapus Terpilih
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pending Page -->
                    <div id="pendingPage" class="page-content" style="display: none;">
                        <div class="content-header">
                            <h2>Menunggu Balasan</h2>
                            <p>Aspirasi yang belum mendapatkan balasan dari OSIS. Segera berikan respon.</p>
                            <div class="quick-actions">
                                <button class="action-btn primary" id="replyAllPending">
                                    <i class="fas fa-reply-all"></i>
                                    Balas Semua
                                </button>
                                <button class="action-btn success" id="markAllAsProcessed">
                                    <i class="fas fa-forward"></i>
                                    Tandai Diproses
                                </button>
                            </div>
                        </div>
                        
                        <div id="pendingSubmissions">
                            <!-- Data will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- Completed Page -->
                    <div id="completedPage" class="page-content" style="display: none;">
                        <div class="content-header">
                            <h2>Selesai Dibalas</h2>
                            <p>Riwayat aspirasi yang sudah mendapatkan balasan dari OSIS.</p>
                            <div class="quick-actions">
                                <button class="action-btn primary" id="exportCompleted">
                                    <i class="fas fa-file-export"></i>
                                    Export Data
                                </button>
                                <button class="action-btn" id="printCompleted">
                                    <i class="fas fa-print"></i>
                                    Cetak Laporan
                                </button>
                            </div>
                        </div>
                        
                        <div id="completedSubmissions">
                            <!-- Data will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Mobile Sidebar -->
        <div class="mobile-sidebar" id="mobileSidebar">
            <div class="mobile-sidebar-header">
                <h3>Menu Admin</h3>
                <button class="close-mobile-sidebar" id="closeMobileSidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <!-- Sidebar content will be copied here -->
        </div>
    </div>

    <!-- Modal Reply -->
    <div class="modal-overlay" id="replyModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Balas Aspirasi</h2>
                <button class="close-modal" id="closeReplyModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3>Detail Aspirasi</h3>
                    <div class="submission-details">
                        <div class="detail-row">
                            <span class="detail-label">ID Tiket:</span>
                            <span class="detail-value" id="modalTicketId">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Jenis:</span>
                            <span class="detail-value" id="modalType">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Kategori:</span>
                            <span class="detail-value" id="modalCategory">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Tanggal:</span>
                            <span class="detail-value" id="modalDate">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Prioritas:</span>
                            <span class="detail-value" id="modalPriority">-</span>
                        </div>
                    </div>
                    
                    <div class="message-box">
                        <h4 style="margin-bottom: 10px; color: var(--gray-700);">Isi Aspirasi/Kritik:</h4>
                        <p id="modalMessage">-</p>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Form Balasan</h3>
                    <form id="replyForm">
                        <div class="form-group">
                            <label for="replyMessage">Balasan OSIS *</label>
                            <textarea id="replyMessage" class="form-control" placeholder="Tulis balasan konstruktif untuk siswa..." required rows="6"></textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="replyStatus">Status</label>
                                <select id="replyStatus" class="form-control" required>
                                    <option value="processed">Diproses</option>
                                    <option value="completed">Selesai</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="replyPublic">Tampilkan Publik?</label>
                                <select id="replyPublic" class="form-control">
                                    <option value="yes">Ya, tampilkan di halaman publik</option>
                                    <option value="no">Tidak, hanya untuk internal</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="replyTemplate">Template Balasan Cepat</label>
                            <select id="replyTemplate" class="form-control">
                                <option value="">Pilih template...</option>
                                <option value="template1">Terima kasih atas aspirasinya</option>
                                <option value="template2">Kritik diterima, akan ditindaklanjuti</option>
                                <option value="template3">Sedang dalam proses koordinasi</option>
                                <option value="template4">Akan dibahas di rapat OSIS</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancelReply">
                                <i class="fas fa-times"></i>
                                Batal
                            </button>
                            <button type="submit" class="btn btn-primary" id="submitReply">
                                <i class="fas fa-paper-plane"></i>
                                Kirim Balasan
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal View Details -->
    <div class="modal-overlay" id="viewModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Detail Lengkap</h2>
                <button class="close-modal" id="closeViewModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3>Informasi Aspirasi</h3>
                    <div class="submission-details">
                        <div class="detail-row">
                            <span class="detail-label">ID Tiket:</span>
                            <span class="detail-value" id="viewTicketId">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Jenis:</span>
                            <span class="detail-value" id="viewType">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Kategori:</span>
                            <span class="detail-value" id="viewCategory">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Tanggal:</span>
                            <span class="detail-value" id="viewDate">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Prioritas:</span>
                            <span class="detail-value" id="viewPriority">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status:</span>
                            <span class="detail-value" id="viewStatus">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Tags/Kelas:</span>
                            <span class="detail-value" id="viewTags">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <h3>Isi Aspirasi/Kritik</h3>
                    <div class="message-box">
                        <p id="viewMessage">-</p>
                    </div>
                </div>
                
                <div class="modal-section" id="replySection" style="display: none;">
                    <h3>Balasan OSIS</h3>
                    <div class="message-box">
                        <div style="color: var(--admin-green); font-weight: 500; margin-bottom: 10px;">
                            <i class="fas fa-reply"></i> Sudah dibalas oleh OSIS
                        </div>
                        <p id="viewReply">-</p>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--gray-200);">
                            <small style="color: var(--gray-500);">
                                <i class="fas fa-calendar"></i> Tanggal balasan: <span id="viewReplyDate">-</span>
                            </small>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="closeView">
                        <i class="fas fa-times"></i>
                        Tutup
                    </button>
                    <button type="button" class="btn btn-primary" id="replyFromView">
                        <i class="fas fa-reply"></i>
                        Balas
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== DATA STORAGE ====================
        // Kunci storage untuk data admin (terpisah dari data publik)
        const ADMIN_STORAGE_KEY = 'suaraosis_admin_submissions';
        const ADMIN_USERS_KEY = 'suaraosis_admin_users';
        const ADMIN_SETTINGS_KEY = 'suaraosis_admin_settings';
        
        // Data default admin
        const defaultAdminUsers = [
            {
                username: 'admin',
                password: 'admin123',
                role: 'admin',
                name: 'Admin Utama'
            },
            {
                username: 'pengurus',
                password: 'osis2024',
                role: 'pengurus',
                name: 'Pengurus OSIS'
            },
            {
                username: 'seksi',
                password: 'aspirasi123',
                role: 'seksi',
                name: 'Seksi Aspirasi'
            }
        ];
        
        // Data default jika belum ada
        let submissions = JSON.parse(localStorage.getItem(ADMIN_STORAGE_KEY)) || [];
        let adminUsers = JSON.parse(localStorage.getItem(ADMIN_USERS_KEY)) || defaultAdminUsers;
        let adminSettings = JSON.parse(localStorage.getItem(ADMIN_SETTINGS_KEY)) || {
            autoRefresh: true,
            notifications: true,
            darkMode: false,
            responseTimeLimit: 7 // hari
        };
        
        // Jika data kosong, ambil dari data publik dan tambah data sample
        if (submissions.length === 0) {
            // Coba ambil dari data publik
            const publicData = JSON.parse(localStorage.getItem('suaraosis_submissions')) || [];
            
            if (publicData.length > 0) {
                submissions = publicData;
            } else {
                // Data sample untuk admin
                submissions = [
                    {
                        id: 'OSIS-1001',
                        type: 'aspiration',
                        category: 'kegiatan',
                        date: '15 November 2023',
                        content: 'Saya usulkan ada kegiatan class meeting sebelum ujian akhir semester untuk refreshing. Bisa berupa lomba-lomba antar kelas yang ringan dan menyenangkan.',
                        reply: 'Terima kasih atas usulannya! OSIS sedang merencanakan Class Meeting Week di minggu kedua Desember. Detail kegiatan akan diumumkan melalui mading.',
                        status: 'completed',
                        tags: ['class meeting', 'lomba', 'refresh'],
                        public: true,
                        priority: 'medium',
                        timestamp: Date.now() - 86400000 * 2,
                        repliedBy: 'Admin Utama',
                        repliedAt: Date.now() - 86400000 * 1
                    },
                    {
                        id: 'OSIS-1002',
                        type: 'critique',
                        category: 'fasilitas',
                        date: '12 November 2023',
                        content: 'Toilet di lantai 3 sangat bau dan sering kekurangan sabun. Mohon diperhatikan kebersihannya karena banyak siswa yang mengeluh.',
                        reply: '',
                        status: 'received',
                        tags: ['toilet', 'kebersihan', 'lantai 3'],
                        public: true,
                        priority: 'high',
                        timestamp: Date.now() - 86400000 * 5
                    },
                    {
                        id: 'OSIS-1003',
                        type: 'aspiration',
                        category: 'ekstrakurikuler',
                        date: '10 November 2023',
                        content: 'Bisa tambah ekstrakurikuler coding atau robotika? Banyak siswa yang tertarik dengan teknologi dan programming.',
                        reply: '',
                        status: 'received',
                        tags: ['ekstrakurikuler', 'coding', 'teknologi'],
                        public: true,
                        priority: 'normal',
                        timestamp: Date.now() - 86400000 * 7
                    },
                    {
                        id: 'OSIS-1004',
                        type: 'aspiration',
                        category: 'lingkungan',
                        date: '5 November 2023',
                        content: 'Bisa dibuat tempat sampah terpisah untuk organik dan anorganik di setiap kelas? Supaya kita bisa belajar pilah sampah sejak di sekolah.',
                        reply: 'Ide yang sangat baik untuk pendidikan lingkungan. OSIS akan koordinasi dengan wali kelas dan bagian kebersihan untuk implementasinya.',
                        status: 'completed',
                        tags: ['lingkungan', 'sampah', 'daur ulang'],
                        public: true,
                        priority: 'medium',
                        timestamp: Date.now() - 86400000 * 10,
                        repliedBy: 'Pengurus OSIS',
                        repliedAt: Date.now() - 86400000 * 8
                    },
                    {
                        id: 'OSIS-1005',
                        type: 'critique',
                        category: 'disiplin',
                        date: '1 November 2023',
                        content: 'Sistem kedisiplinan terlalu berat untuk pelanggaran kecil. Mending diberi peringatan dulu sebelum langsung diberikan sanksi.',
                        reply: 'Masukan diterima. OSIS akan evaluasi sistem poin pelanggaran dan pertimbangkan sistem peringatan bertahap di rapat mendatang.',
                        status: 'processed',
                        tags: ['disiplin', 'sanksi', 'sistem'],
                        public: false,
                        priority: 'high',
                        timestamp: Date.now() - 86400000 * 14,
                        repliedBy: 'Seksi Aspirasi',
                        repliedAt: Date.now() - 86400000 * 12
                    },
                    {
                        id: 'OSIS-1006',
                        type: 'aspiration',
                        category: 'akademik',
                        date: '28 Oktober 2023',
                        content: 'Bisa minta tambahan jam belajar untuk persiapan ujian nasional? Terutama untuk mata pelajaran yang sulit seperti matematika dan fisika.',
                        reply: '',
                        status: 'received',
                        tags: ['akademik', 'ujian', 'belajar'],
                        public: true,
                        priority: 'urgent',
                        timestamp: Date.now() - 86400000 * 16
                    },
                    {
                        id: 'OSIS-1007',
                        type: 'critique',
                        category: 'fasilitas',
                        date: '25 Oktober 2023',
                        content: 'Proyektor di ruang kelas sering rusak dan ganggu proses belajar. Mohon diperbaiki atau diganti.',
                        reply: 'Laporan diterima. OSIS akan koordinasi dengan bagian sarpras untuk pengecekan proyektor di semua ruang kelas.',
                        status: 'completed',
                        tags: ['proyektor', 'fasilitas', 'kelas'],
                        public: true,
                        priority: 'high',
                        timestamp: Date.now() - 86400000 * 19,
                        repliedBy: 'Admin Utama',
                        repliedAt: Date.now() - 86400000 * 17
                    },
                    {
                        id: 'OSIS-1008',
                        type: 'aspiration',
                        category: 'kegiatan',
                        date: '20 Oktober 2023',
                        content: 'Usul untuk buka stand jualan makanan sehat di sekolah, biar kita bisa jajan yang sehat dan mendukung UKS.',
                        reply: '',
                        status: 'received',
                        tags: ['makanan', 'kesehatan', 'UKS'],
                        public: true,
                        priority: 'medium',
                        timestamp: Date.now() - 86400000 * 23
                    }
                ];
            }
            
            saveAdminData();
        }
        
        // ==================== STATE VARIABLES ====================
        let currentUser = null;
        let currentPage = 'dashboard';
        let currentSubmission = null;
        let selectedSubmissions = new Set();
        let tableFilter = 'all';
        
        // ==================== DOM ELEMENTS ====================
        // Login Page
        const loginPage = document.getElementById('loginPage');
        const loginForm = document.getElementById('loginForm');
        const adminDashboard = document.getElementById('adminDashboard');
        
        // Admin Dashboard
        const themeToggle = document.getElementById('themeToggle');
        const refreshBtn = document.getElementById('refreshBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const adminName = document.getElementById('adminName');
        
        // Navigation
        const navItems = document.querySelectorAll('.admin-nav-item');
        const pageContents = document.querySelectorAll('.page-content');
        
        // Dashboard Elements
        const totalCount = document.getElementById('totalCount');
        const pendingCount = document.getElementById('pendingCount');
        const completedCount = document.getElementById('completedCount');
        const avgResponseTime = document.getElementById('avgResponseTime');
        const recentSubmissions = document.getElementById('recentSubmissions');
        const sidebarPendingCount = document.getElementById('sidebarPendingCount');
        
        // Stats
        const statToday = document.getElementById('statToday');
        const statReplied = document.getElementById('statReplied');
        const statAvgTime = document.getElementById('statAvgTime');
        
        // Table Controls
        const tableControls = document.querySelectorAll('.table-control');
        const searchInput = document.getElementById('searchInput');
        const categoryFilter = document.getElementById('categoryFilter');
        const statusFilter = document.getElementById('statusFilter');
        const selectAll = document.getElementById('selectAll');
        const allSubmissions = document.getElementById('allSubmissions');
        const filteredCount = document.getElementById('filteredCount');
        
        // Quick Actions
        const quickReply = document.getElementById('quickReply');
        const markAllProcessed = document.getElementById('markAllProcessed');
        const exportData = document.getElementById('exportData');
        const bulkProcess = document.getElementById('bulkProcess');
        const bulkComplete = document.getElementById('bulkComplete');
        const bulkDelete = document.getElementById('bulkDelete');
        
        // Pages
        const pendingSubmissions = document.getElementById('pendingSubmissions');
        const completedSubmissions = document.getElementById('completedSubmissions');
        
        // Modals
        const replyModal = document.getElementById('replyModal');
        const closeReplyModal = document.getElementById('closeReplyModal');
        const cancelReply = document.getElementById('cancelReply');
        const replyForm = document.getElementById('replyForm');
        const submitReply = document.getElementById('submitReply');
        const replyTemplate = document.getElementById('replyTemplate');
        
        const viewModal = document.getElementById('viewModal');
        const closeViewModal = document.getElementById('closeViewModal');
        const closeView = document.getElementById('closeView');
        const replyFromView = document.getElementById('replyFromView');
        
        // Mobile
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileSidebar = document.getElementById('mobileSidebar');
        const closeMobileSidebar = document.getElementById('closeMobileSidebar');
        
        // ==================== HELPER FUNCTIONS ====================
        function saveAdminData() {
            localStorage.setItem(ADMIN_STORAGE_KEY, JSON.stringify(submissions));
            localStorage.setItem(ADMIN_USERS_KEY, JSON.stringify(adminUsers));
            localStorage.setItem(ADMIN_SETTINGS_KEY, JSON.stringify(adminSettings));
            
            // Juga simpan ke data publik untuk sinkronisasi
            const publicSubmissions = submissions.filter(sub => sub.public);
            localStorage.setItem('suaraosis_submissions', JSON.stringify(publicSubmissions));
        }
        
        function getCategoryText(category) {
            const categories = {
                'kegiatan': 'Kegiatan OSIS',
                'fasilitas': 'Fasilitas Sekolah',
                'akademik': 'Program Akademik',
                'ekstrakurikuler': 'Ekstrakurikuler',
                'lingkungan': 'Lingkungan Sekolah',
                'disiplin': 'Kedisiplinan',
                'other': 'Lainnya'
            };
            return categories[category] || 'Lainnya';
        }
        
        function getStatusText(status) {
            switch(status) {
                case 'received': return 'Diterima';
                case 'processed': return 'Diproses';
                case 'completed': return 'Selesai';
                default: return 'Diterima';
            }
        }
        
        function getStatusBadge(status) {
            const text = getStatusText(status);
            switch(status) {
                case 'received': return `<span class="badge badge-status">${text}</span>`;
                case 'processed': return `<span class="badge badge-processed">${text}</span>`;
                case 'completed': return `<span class="badge badge-completed">${text}</span>`;
                default: return `<span class="badge badge-status">${text}</span>`;
            }
        }
        
        function getTypeBadge(type) {
            const text = type === 'aspiration' ? 'Aspirasi' : 'Kritik';
            const className = type === 'aspiration' ? 'badge-aspiration' : 'badge-critique';
            return `<span class="badge ${className}">${text}</span>`;
        }
        
        function getPriorityBadge(priority) {
            const priorities = {
                'normal': 'Normal',
                'medium': 'Sedang',
                'high': 'Tinggi',
                'urgent': 'Mendesak'
            };
            const text = priorities[priority] || 'Normal';
            return `<span class="badge badge-priority">${text}</span>`;
        }
        
        function calculateStats() {
            const today = new Date().toLocaleDateString('id-ID');
            const todaySubmissions = submissions.filter(sub => sub.date === today);
            const repliedToday = todaySubmissions.filter(sub => sub.reply && sub.reply.trim() !== '');
            
            const pending = submissions.filter(sub => !sub.reply || sub.reply.trim() === '');
            const completed = submissions.filter(sub => sub.reply && sub.reply.trim() !== '');
            
            // Calculate average response time
            let totalResponseTime = 0;
            let respondedCount = 0;
            
            submissions.forEach(sub => {
                if (sub.reply && sub.reply.trim() !== '' && sub.timestamp && sub.repliedAt) {
                    const responseTime = sub.repliedAt - sub.timestamp;
                    totalResponseTime += responseTime;
                    respondedCount++;
                }
            });
            
            const avgTime = respondedCount > 0 ? totalResponseTime / respondedCount : 0;
            const avgHours = Math.round(avgTime / (1000 * 60 * 60));
            
            // Update UI
            totalCount.textContent = submissions.length;
            pendingCount.textContent = pending.length;
            completedCount.textContent = completed.length;
            avgResponseTime.textContent = `${avgHours}h`;
            
            statToday.textContent = todaySubmissions.length;
            statReplied.textContent = repliedToday.length;
            statAvgTime.textContent = `${avgHours}h`;
            
            sidebarPendingCount.textContent = pending.length;
            
            return { pending, completed, avgHours };
        }
        
        function renderRecentSubmissions() {
            const recent = [...submissions]
                .sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0))
                .slice(0, 8);
            
            recentSubmissions.innerHTML = '';
            
            if (recent.length === 0) {
                recentSubmissions.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: var(--gray-500);">
                            <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 15px; display: block; opacity: 0.5;"></i>
                            Belum ada aspirasi yang masuk
                        </td>
                    </tr>
                `;
                return;
            }
            
            recent.forEach(submission => {
                const row = document.createElement('tr');
                row.dataset.id = submission.id;
                
                row.innerHTML = `
                    <td>
                        <strong>${submission.id}</strong>
                        ${submission.priority === 'urgent' ? ' <i class="fas fa-exclamation-circle" style="color: var(--admin-red);"></i>' : ''}
                    </td>
                    <td>${submission.date}</td>
                    <td>${getTypeBadge(submission.type)}</td>
                    <td>${getCategoryText(submission.category)}</td>
                    <td>${getStatusBadge(submission.status)}</td>
                    <td>${getPriorityBadge(submission.priority)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn-small view" data-id="${submission.id}" title="Lihat Detail">
                                <i class="fas fa-eye"></i>
                            </button>
                            ${!submission.reply || submission.reply.trim() === '' ? `
                            <button class="action-btn-small reply" data-id="${submission.id}" title="Balas">
                                <i class="fas fa-reply"></i>
                            </button>
                            ` : ''}
                        </div>
                    </td>
                `;
                
                recentSubmissions.appendChild(row);
            });
            
            attachSubmissionEvents();
        }
        
        function renderAllSubmissions(filter = 'all', search = '', category = '', status = '') {
            let filtered = [...submissions];
            
            // Apply filter
            if (filter === 'aspiration') {
                filtered = filtered.filter(sub => sub.type === 'aspiration');
            } else if (filter === 'critique') {
                filtered = filtered.filter(sub => sub.type === 'critique');
            } else if (filter === 'urgent') {
                filtered = filtered.filter(sub => sub.priority === 'urgent');
            }
            
            // Apply search
            if (search) {
                const searchLower = search.toLowerCase();
                filtered = filtered.filter(sub => 
                    sub.id.toLowerCase().includes(searchLower) ||
                    sub.content.toLowerCase().includes(searchLower) ||
                    (sub.tags && sub.tags.some(tag => tag.toLowerCase().includes(searchLower)))
                );
            }
            
            // Apply category filter
            if (category) {
                filtered = filtered.filter(sub => sub.category === category);
            }
            
            // Apply status filter
            if (status) {
                filtered = filtered.filter(sub => sub.status === status);
            }
            
            // Update count
            filteredCount.textContent = filtered.length;
            
            // Render table
            allSubmissions.innerHTML = '';
            
            if (filtered.length === 0) {
                allSubmissions.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: var(--gray-500);">
                            <i class="fas fa-search" style="font-size: 48px; margin-bottom: 15px; display: block; opacity: 0.5;"></i>
                            Tidak ada data yang sesuai dengan filter
                        </td>
                    </tr>
                `;
                return;
            }
            
            filtered.forEach(submission => {
                const row = document.createElement('tr');
                row.dataset.id = submission.id;
                
                if (submission.priority === 'urgent') {
                    row.style.backgroundColor = 'rgba(220, 38, 38, 0.05)';
                }
                
                const isSelected = selectedSubmissions.has(submission.id);
                
                row.innerHTML = `
                    <td>
                        <input type="checkbox" class="submission-checkbox" data-id="${submission.id}" ${isSelected ? 'checked' : ''}>
                    </td>
                    <td>
                        <strong>${submission.id}</strong>
                        ${submission.priority === 'urgent' ? ' <i class="fas fa-exclamation-circle" style="color: var(--admin-red);"></i>' : ''}
                    </td>
                    <td>${submission.date}</td>
                    <td>${getTypeBadge(submission.type)}</td>
                    <td>${getCategoryText(submission.category)}</td>
                    <td>${getStatusBadge(submission.status)}</td>
                    <td>${getPriorityBadge(submission.priority)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn-small view" data-id="${submission.id}" title="Lihat Detail">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn-small reply" data-id="${submission.id}" title="Balas">
                                <i class="fas fa-reply"></i>
                            </button>
                            <button class="action-btn-small edit" data-id="${submission.id}" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn-small delete" data-id="${submission.id}" title="Hapus">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                allSubmissions.appendChild(row);
            });
            
            attachSubmissionEvents();
            attachCheckboxEvents();
        }
        
        function renderPendingSubmissions() {
            const pending = submissions.filter(sub => !sub.reply || sub.reply.trim() === '');
            
            pendingSubmissions.innerHTML = '';
            
            if (pending.length === 0) {
                pendingSubmissions.innerHTML = `
                    <div class="dashboard-card" style="text-align: center;">
                        <div class="card-icon icon-green" style="margin: 0 auto 20px;">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3 style="color: var(--admin-green); margin-bottom: 10px;">Semua Selesai!</h3>
                        <p>Tidak ada aspirasi yang menunggu balasan. Kerja bagus!</p>
                    </div>
                `;
                return;
            }
            
            pending.forEach(submission => {
                const card = document.createElement('div');
                card.className = 'dashboard-card';
                card.dataset.id = submission.id;
                
                // Calculate days pending
                const daysPending = submission.timestamp ? 
                    Math.floor((Date.now() - submission.timestamp) / (1000 * 60 * 60 * 24)) : 0;
                
                let daysText = '';
                if (daysPending === 0) {
                    daysText = '<span style="color: var(--admin-green);">Hari ini</span>';
                } else if (daysPending === 1) {
                    daysText = '<span style="color: var(--admin-yellow);">1 hari lalu</span>';
                } else {
                    daysText = `<span style="color: var(--admin-red);">${daysPending} hari lalu</span>`;
                }
                
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${submission.id} - ${getCategoryText(submission.category)}</h3>
                        <div class="card-icon ${submission.priority === 'urgent' ? 'icon-red' : 'icon-yellow'}">
                            <i class="fas ${submission.priority === 'urgent' ? 'fa-exclamation-triangle' : 'fa-clock'}"></i>
                        </div>
                    </div>
                    <div class="card-content">
                        <p style="margin-bottom: 15px; color: var(--gray-700); line-height: 1.6;">
                            ${submission.content.substring(0, 150)}${submission.content.length > 150 ? '...' : ''}
                        </p>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                            <div>
                                ${getTypeBadge(submission.type)}
                                ${getPriorityBadge(submission.priority)}
                                <span style="color: var(--gray-500); font-size: 13px; margin-left: 10px;">
                                    <i class="far fa-calendar"></i> ${daysText}
                                </span>
                            </div>
                            <div class="action-buttons">
                                <button class="action-btn-small view" data-id="${submission.id}" title="Lihat Detail">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="action-btn-small reply" data-id="${submission.id}" title="Balas">
                                    <i class="fas fa-reply"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                pendingSubmissions.appendChild(card);
            });
            
            attachSubmissionEvents();
        }
        
        function renderCompletedSubmissions() {
            const completed = submissions.filter(sub => sub.reply && sub.reply.trim() !== '');
            
            completedSubmissions.innerHTML = '';
            
            if (completed.length === 0) {
                completedSubmissions.innerHTML = `
                    <div class="dashboard-card" style="text-align: center;">
                        <div class="card-icon icon-blue" style="margin: 0 auto 20px;">
                            <i class="fas fa-inbox"></i>
                        </div>
                        <h3 style="color: var(--admin-blue); margin-bottom: 10px;">Belum Ada yang Selesai</h3>
                        <p>Belum ada aspirasi yang dibalas. Mulai balas aspirasi yang masuk!</p>
                    </div>
                `;
                return;
            }
            
            completed.forEach(submission => {
                const card = document.createElement('div');
                card.className = 'dashboard-card';
                card.dataset.id = submission.id;
                
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${submission.id} - ${getCategoryText(submission.category)}</h3>
                        <div class="card-icon icon-green">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="card-content">
                        <p style="margin-bottom: 15px; color: var(--gray-700); line-height: 1.6;">
                            <strong>Aspirasi:</strong> ${submission.content.substring(0, 120)}${submission.content.length > 120 ? '...' : ''}
                        </p>
                        <p style="margin-bottom: 15px; color: var(--admin-green); line-height: 1.6; font-size: 14px;">
                            <strong>Balasan:</strong> ${submission.reply.substring(0, 120)}${submission.reply.length > 120 ? '...' : ''}
                        </p>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                            <div>
                                ${getTypeBadge(submission.type)}
                                <span style="color: var(--gray-500); font-size: 13px; margin-left: 10px;">
                                    <i class="far fa-calendar"></i> ${submission.date}
                                </span>
                                ${submission.repliedBy ? `
                                <span style="color: var(--gray-500); font-size: 13px; margin-left: 10px;">
                                    <i class="fas fa-user"></i> ${submission.repliedBy}
                                </span>
                                ` : ''}
                            </div>
                            <div class="action-buttons">
                                <button class="action-btn-small view" data-id="${submission.id}" title="Lihat Detail">
                                    <i class="fas fa-eye"></i>
                                </button>
                                ${submission.public ? '<span class="badge badge-status" style="font-size: 11px;">Publik</span>' : ''}
                            </div>
                        </div>
                    </div>
                `;
                
                completedSubmissions.appendChild(card);
            });
            
            attachSubmissionEvents();
        }
        
        function populateCategoryFilter() {
            const categories = [...new Set(submissions.map(sub => sub.category))];
            categoryFilter.innerHTML = '<option value="">Semua Kategori</option>';
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = getCategoryText(category);
                categoryFilter.appendChild(option);
            });
        }
        
        function attachSubmissionEvents() {
            // View buttons
            document.querySelectorAll('.action-btn-small.view').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.dataset.id;
                    const submission = submissions.find(sub => sub.id === id);
                    if (submission) {
                        showViewModal(submission);
                    }
                });
            });
            
            // Reply buttons
            document.querySelectorAll('.action-btn-small.reply').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.dataset.id;
                    const submission = submissions.find(sub => sub.id === id);
                    if (submission) {
                        showReplyModal(submission);
                    }
                });
            });
            
            // Edit buttons
            document.querySelectorAll('.action-btn-small.edit').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.dataset.id;
                    // For now, just open reply modal
                    const submission = submissions.find(sub => sub.id === id);
                    if (submission) {
                        showReplyModal(submission);
                    }
                });
            });
            
            // Delete buttons
            document.querySelectorAll('.action-btn-small.delete').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.dataset.id;
                    if (confirm(`Hapus aspirasi ${id}? Tindakan ini tidak dapat dibatalkan.`)) {
                        submissions = submissions.filter(sub => sub.id !== id);
                        saveAdminData();
                        updateUI();
                    }
                });
            });
        }
        
        function attachCheckboxEvents() {
            document.querySelectorAll('.submission-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const id = e.target.dataset.id;
                    if (e.target.checked) {
                        selectedSubmissions.add(id);
                    } else {
                        selectedSubmissions.delete(id);
                    }
                    
                    // Update select all checkbox
                    const allChecked = document.querySelectorAll('.submission-checkbox').length === selectedSubmissions.size;
                    selectAll.checked = allChecked;
                });
            });
            
            selectAll.addEventListener('change', (e) => {
                const isChecked = e.target.checked;
                document.querySelectorAll('.submission-checkbox').forEach(checkbox => {
                    checkbox.checked = isChecked;
                    const id = checkbox.dataset.id;
                    if (isChecked) {
                        selectedSubmissions.add(id);
                    } else {
                        selectedSubmissions.delete(id);
                    }
                });
            });
        }
        
        function showReplyModal(submission) {
            currentSubmission = submission;
            
            // Populate modal
            document.getElementById('modalTicketId').textContent = submission.id;
            document.getElementById('modalType').textContent = submission.type === 'aspiration' ? 'Aspirasi' : 'Kritik';
            document.getElementById('modalCategory').textContent = getCategoryText(submission.category);
            document.getElementById('modalDate').textContent = submission.date;
            document.getElementById('modalPriority').textContent = getPriorityBadge(submission.priority);
            document.getElementById('modalMessage').textContent = submission.content;
            
            // Clear form
            document.getElementById('replyMessage').value = submission.reply || '';
            document.getElementById('replyStatus').value = submission.status || 'processed';
            document.getElementById('replyPublic').value = submission.public ? 'yes' : 'no';
            document.getElementById('replyTemplate').value = '';
            
            replyModal.classList.add('show');
        }
        
        function showViewModal(submission) {
            // Populate modal
            document.getElementById('viewTicketId').textContent = submission.id;
            document.getElementById('viewType').textContent = submission.type === 'aspiration' ? 'Aspirasi' : 'Kritik';
            document.getElementById('viewCategory').textContent = getCategoryText(submission.category);
            document.getElementById('viewDate').textContent = submission.date;
            document.getElementById('viewPriority').innerHTML = getPriorityBadge(submission.priority);
            document.getElementById('viewStatus').innerHTML = getStatusBadge(submission.status);
            document.getElementById('viewTags').textContent = submission.tags ? submission.tags.join(', ') : '-';
            document.getElementById('viewMessage').textContent = submission.content;
            
            // Reply section
            const replySection = document.getElementById('replySection');
            if (submission.reply && submission.reply.trim() !== '') {
                replySection.style.display = 'block';
                document.getElementById('viewReply').textContent = submission.reply;
                document.getElementById('viewReplyDate').textContent = submission.repliedAt ? 
                    new Date(submission.repliedAt).toLocaleDateString('id-ID') : submission.date;
            } else {
                replySection.style.display = 'none';
            }
            
            viewModal.classList.add('show');
        }
        
        function updateUI() {
            calculateStats();
            renderRecentSubmissions();
            renderAllSubmissions(tableFilter, searchInput.value, categoryFilter.value, statusFilter.value);
            renderPendingSubmissions();
            renderCompletedSubmissions();
            populateCategoryFilter();
        }
        
        function switchPage(page) {
            currentPage = page;
            
            // Update navigation
            navItems.forEach(item => {
                if (item.dataset.page === page) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // Update content
            pageContents.forEach(content => {
                if (content.id === `${page}Page`) {
                    content.style.display = 'block';
                    content.classList.add('active');
                } else {
                    content.style.display = 'none';
                    content.classList.remove('active');
                }
            });
            
            // Update mobile sidebar
            mobileSidebar.classList.remove('show');
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // ==================== EVENT LISTENERS ====================
        // Login
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;
            
            // Simple authentication
            const user = adminUsers.find(u => 
                u.username === username && 
                u.password === password && 
                u.role === role
            );
            
            if (user) {
                currentUser = user;
                adminName.textContent = user.name;
                
                // Show admin dashboard
                loginPage.style.display = 'none';
                adminDashboard.style.display = 'block';
                
                // Update theme
                if (adminSettings.darkMode) {
                    document.body.classList.add('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>Mode Terang</span>';
                }
                
                // Initialize UI
                updateUI();
                
                // Show welcome message
                setTimeout(() => {
                    alert(`Selamat datang, ${user.name}!`);
                }, 100);
            } else {
                alert('Login gagal. Periksa username, password, dan peran Anda.');
            }
        });
        
        // Theme toggle
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            adminSettings.darkMode = document.body.classList.contains('dark-mode');
            
            if (adminSettings.darkMode) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>Mode Terang</span>';
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>Mode Gelap</span>';
            }
            
            saveAdminData();
        });
        
        // Refresh
        refreshBtn.addEventListener('click', () => {
            updateUI();
            alert('Data diperbarui!');
        });
        
        // Logout
        logoutBtn.addEventListener('click', () => {
            if (confirm('Keluar dari panel admin?')) {
                currentUser = null;
                adminDashboard.style.display = 'none';
                loginPage.style.display = 'flex';
                loginForm.reset();
            }
        });
        
        // Navigation
        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const page = item.dataset.page;
                switchPage(page);
            });
        });
        
        // Table filters
        tableControls.forEach(control => {
            control.addEventListener('click', () => {
                tableControls.forEach(c => c.classList.remove('active'));
                control.classList.add('active');
                tableFilter = control.dataset.filter;
                renderAllSubmissions(tableFilter, searchInput.value, categoryFilter.value, statusFilter.value);
            });
        });
        
        // Search and filters
        searchInput.addEventListener('input', () => {
            renderAllSubmissions(tableFilter, searchInput.value, categoryFilter.value, statusFilter.value);
        });
        
        categoryFilter.addEventListener('change', () => {
            renderAllSubmissions(tableFilter, searchInput.value, categoryFilter.value, statusFilter.value);
        });
        
        statusFilter.addEventListener('change', () => {
            renderAllSubmissions(tableFilter, searchInput.value, categoryFilter.value, statusFilter.value);
        });
        
        // Quick actions
        quickReply.addEventListener('click', () => {
            const pending = submissions.filter(sub => !sub.reply || sub.reply.trim() === '');
            if (pending.length === 0) {
                alert('Tidak ada aspirasi yang menunggu balasan.');
            } else {
                switchPage('pending');
            }
        });
        
        markAllProcessed.addEventListener('click', () => {
            if (confirm('Tandai semua aspirasi sebagai "Diproses"? Status akan diubah tetapi balasan tetap kosong.')) {
                submissions.forEach(sub => {
                    if (!sub.reply || sub.reply.trim() === '') {
                        sub.status = 'processed';
                    }
                });
                saveAdminData();
                updateUI();
                alert('Semua aspirasi ditandai sebagai Diproses.');
            }
        });
        
        exportData.addEventListener('click', () => {
            const dataStr = JSON.stringify(submissions, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            const exportFileDefaultName = `aspirasi-osis-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert('Data berhasil diexport!');
        });
        
        // Bulk actions
        bulkProcess.addEventListener('click', () => {
            if (selectedSubmissions.size === 0) {
                alert('Pilih minimal satu aspirasi terlebih dahulu.');
                return;
            }
            
            if (confirm(`Tandai ${selectedSubmissions.size} aspirasi sebagai "Diproses"?`)) {
                submissions.forEach(sub => {
                    if (selectedSubmissions.has(sub.id)) {
                        sub.status = 'processed';
                    }
                });
                saveAdminData();
                updateUI();
                selectedSubmissions.clear();
                alert('Aspirasi terpilih ditandai sebagai Diproses.');
            }
        });
        
        bulkComplete.addEventListener('click', () => {
            if (selectedSubmissions.size === 0) {
                alert('Pilih minimal satu aspirasi terlebih dahulu.');
                return;
            }
            
            if (confirm(`Tandai ${selectedSubmissions.size} aspirasi sebagai "Selesai"? Anda perlu membalasnya nanti.`)) {
                submissions.forEach(sub => {
                    if (selectedSubmissions.has(sub.id)) {
                        sub.status = 'completed';
                        if (!sub.reply || sub.reply.trim() === '') {
                            sub.reply = 'Telah diproses oleh OSIS. Detail akan menyusul.';
                        }
                    }
                });
                saveAdminData();
                updateUI();
                selectedSubmissions.clear();
                alert('Aspirasi terpilih ditandai sebagai Selesai.');
            }
        });
        
        bulkDelete.addEventListener('click', () => {
            if (selectedSubmissions.size === 0) {
                alert('Pilih minimal satu aspirasi terlebih dahulu.');
                return;
            }
            
            if (confirm(`Hapus ${selectedSubmissions.size} aspirasi? Tindakan ini tidak dapat dibatalkan.`)) {
                submissions = submissions.filter(sub => !selectedSubmissions.has(sub.id));
                saveAdminData();
                updateUI();
                selectedSubmissions.clear();
                alert('Aspirasi terpilih berhasil dihapus.');
            }
        });
        
        // Reply modal
        closeReplyModal.addEventListener('click', () => {
            replyModal.classList.remove('show');
        });
        
        cancelReply.addEventListener('click', () => {
            replyModal.classList.remove('show');
        });
        
        replyModal.addEventListener('click', (e) => {
            if (e.target === replyModal) {
                replyModal.classList.remove('show');
            }
        });
        
        replyTemplate.addEventListener('change', (e) => {
            const template = e.target.value;
            let replyText = '';
            
            switch(template) {
                case 'template1':
                    replyText = 'Terima kasih atas aspirasi/kritik yang telah Anda sampaikan. OSIS sangat menghargai partisipasi Anda dalam membangun sekolah yang lebih baik. Usulan Anda akan kami pertimbangkan dalam rapat OSIS mendatang.';
                    break;
                case 'template2':
                    replyText = 'Kritik dan masukan Anda telah kami terima dengan baik. OSIS akan menindaklanjuti hal ini dan melakukan evaluasi untuk perbaikan ke depan. Terima kasih telah peduli terhadap perkembangan sekolah kita.';
                    break;
                case 'template3':
                    replyText = 'Aspirasi Anda sedang dalam proses koordinasi dengan pihak terkait. OSIS akan memberikan update lebih lanjut setelah ada perkembangan. Mohon menunggu dan terima kasih atas pengertiannya.';
                    break;
                case 'template4':
                    replyText = 'Usulan Anda akan dibahas dalam rapat OSIS minggu depan. Kami akan mempertimbangkan dengan matang dan melihat kemungkinan implementasinya. Terima kasih atas kontribusi Anda untuk sekolah.';
                    break;
            }
            
            if (replyText) {
                document.getElementById('replyMessage').value = replyText;
            }
        });
        
        replyForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const replyMessage = document.getElementById('replyMessage').value;
            const replyStatus = document.getElementById('replyStatus').value;
            const replyPublic = document.getElementById('replyPublic').value === 'yes';
            
            if (!replyMessage.trim()) {
                alert('Isi balasan tidak boleh kosong.');
                return;
            }
            
            // Update submission
            const submissionIndex = submissions.findIndex(sub => sub.id === currentSubmission.id);
            if (submissionIndex !== -1) {
                submissions[submissionIndex].reply = replyMessage;
                submissions[submissionIndex].status = replyStatus;
                submissions[submissionIndex].public = replyPublic;
                submissions[submissionIndex].repliedBy = currentUser.name;
                submissions[submissionIndex].repliedAt = Date.now();
                
                saveAdminData();
                updateUI();
                
                replyModal.classList.remove('show');
                alert('Balasan berhasil dikirim!');
            }
        });
        
        // View modal
        closeViewModal.addEventListener('click', () => {
            viewModal.classList.remove('show');
        });
        
        closeView.addEventListener('click', () => {
            viewModal.classList.remove('show');
        });
        
        viewModal.addEventListener('click', (e) => {
            if (e.target === viewModal) {
                viewModal.classList.remove('show');
            }
        });
        
        replyFromView.addEventListener('click', () => {
            viewModal.classList.remove('show');
            setTimeout(() => {
                showReplyModal(currentSubmission);
            }, 300);
        });
        
        // Mobile menu
        mobileMenuBtn.addEventListener('click', () => {
            mobileSidebar.classList.add('show');
            // Copy sidebar content to mobile sidebar
            const sidebarContent = document.querySelector('.admin-sidebar').cloneNode(true);
            mobileSidebar.innerHTML = '';
            mobileSidebar.appendChild(document.querySelector('.mobile-sidebar-header'));
            mobileSidebar.appendChild(sidebarContent);
            
            // Reattach events
            mobileSidebar.querySelectorAll('.admin-nav-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = item.dataset.page;
                    switchPage(page);
                });
            });
        });
        
        closeMobileSidebar.addEventListener('click', () => {
            mobileSidebar.classList.remove('show');
        });
        
        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Check if already logged in
            const savedUser = localStorage.getItem('suaraosis_current_user');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    adminName.textContent = currentUser.name;
                    loginPage.style.display = 'none';
                    adminDashboard.style.display = 'block';
                    updateUI();
                } catch (e) {
                    localStorage.removeItem('suaraosis_current_user');
                }
            }
            
            // Apply dark mode if enabled
            if (adminSettings.darkMode) {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>Mode Terang</span>';
            }
            
            // Save current user on logout
            logoutBtn.addEventListener('click', () => {
                localStorage.removeItem('suaraosis_current_user');
            });
            
            // Save user on login
            loginForm.addEventListener('submit', () => {
                if (currentUser) {
                    localStorage.setItem('suaraosis_current_user', JSON.stringify(currentUser));
                }
            });
            
            console.log('Admin Panel OSIS siap digunakan!');
        });
    </script>
</body>
</html>
